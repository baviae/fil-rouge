---
vars:
  docker_compose_version: "1.27.4"
tasks:
  - name: Update apt cache
    apt: update_cache=yes cache_valid_time=3600

  - name: Upgrade all apt packages
     apt: upgrade=dist

  - name: Install dependencies
    apt:
      name: "{{ dependencies_packages }}"
      state: present
      update_cache: yes

  - name: Add an apt signing key for Docker
    apt_key:
      url: https://download.docker.com/linux/ubuntu/gpg
      state: present

  - name: Add apt repository for stable version
    apt_repository:
      repo: deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable
      state: present

  - name: Install Docker
    apt:
      name: "{{ docker_packages }}"
      state: present
      update_cache: yes