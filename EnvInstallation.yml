---
- name: use a dedicated Ansible module
  hosts: all
  become: true
  vars_files:
    - secret
  tasks:
    - name: Update apt cache
      apt: update_cache=yes cache_valid_time=3600

    - name: Upgrade all apt packages
      apt: upgrade=dist

    - name: installation postgres
      command: sudo docker pull postgres

    - name : create Data Base and user name passeword And run container
      command: sudo docker run --name postgreDB -p 5432:5432 -e POSTGRES_PASSWORD=1234  -e POSTGRES_USER=baviae -e POSTGRES_DB=ecoCom -d postgres

    - name: go to app back
      command: cd ./eco-commerce

    - name: build l'image de l'apply java
      command: sudo docker build . -t java-application

    - name: Lancement du container de l'apply java
      command: sudo docker run --network "host" -p 8080:8080 -d java-application

    - name: go to app front
      command: cd ../eco-commerce-front

    - name: build l'image de l'apply angular
      command: sudo docker build . -t app-front

    - name: Lancement du container de l'apply
      command: sudo docker run -p 4200:4200 --name app-fronts --network "host" -d --rm app-front


